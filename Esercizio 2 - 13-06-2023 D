#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

#include "aux.h"


TipoLista prima_ultima(TipoLista l1,TipoLista l2,int k,int j){
  if(estVuota(l2)) return listaVuota();
  if(length(l2)<=j) return cons(car(l2),prima_ultima(l1,cdr(l2),k,j));
  if(k>0) return cons(car(l1),prima_ultima(cdr(l1),l2,k-1,j));
  return prima_ultima(l1,cdr(l2),k,j);
}

TipoLista porzioneDiListe(TipoLista l1, TipoLista l2, int k) {
  if(k==0 || estVuota(l1) && estVuota(l2)) return listaVuota();
	return prima_ultima(l1,l2,k,k);
}

int somma(TipoLista l){
  if(estVuota(l)) return 0;
  else return car(l)+somma(cdr(l));
}


TipoLista aux(TipoLista* liste1, TipoLista* liste2, int n, int k,int pos) {
  if(pos==n) return listaVuota();
  if(pos<n) return cons(somma(porzioneDiListe(liste1[pos],liste2[pos],k)),aux(liste1+1,liste2+1,n,k,pos+1));
  return aux(liste1+1,liste2+1,n,k,pos+1);
}
TipoLista diffPorzioniDiListe(TipoLista* liste1, TipoLista* liste2, int n, int k) {
  if(n==0) return listaVuota();
  return aux(liste1,liste2,n,k,0);
 
}
